{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./www/src/app.js","webpack:///./www/src/modules/contrat.js","webpack:///./www/src/modules/modal.js"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AACiD;;AAEjD;AACA,GAAG,4DAAiB;AACpB;;;;;;;;;;;;;;ACLA;AAAA;AAAA;AAAoC;AACpC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB;AACO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,Y;AACA;AACA;;AAEA;AACA;AACA,WAAW,IAAI;AACf;AACA;AACA;AACA,EAAE,qDAAiB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,EAAE,oDAAgB;AAClB;AACA;;AAEA;AACA;AACA,EAAE,qDAAiB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE,oDAAgB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;;AAGA;AACA;AACA;AACA,EAAE,qDAAiB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE,oDAAgB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,C;;;;;;;;;;;;ACxQA;AAAA;AAAA;AAAA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA,WAAW,EAAE;AACb,WAAW,EAAE;AACb;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD,mB;AACA,Q;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,C","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./www/src/app.js\");\n","//import * as user from './modules/user.js';\nimport * as mContrat from './modules/contrat.js';\n\nwindow.contrat = function(action, params){\n   mContrat.doAction(action, params);\n}\n\n","import * as modal from './modal.js';\n/**\n * Gestion des contrats\n */\n\n/**\n * doAction \n * \n * Aiguillage des demandes liées au contrat\n * @param {string} action   Action demandée\n * @param {objet} params    Paramètres requis\n */\nexport function doAction(action, params)\n{\n  switch(action)\n  {\n    case 'init':\n      initFormContact(0);\n      break;\n\n    case 'edit':\n      // Retrouver id\n      var id=params;\n      initFormContact(id);\n      break;\n    \n    case 'chooseProducer':\n      chooseUser('Producteur',\"Choisir un producteur\");\n      break;\n\n    case 'chooseReferent':\n      chooseUser('Referent',\"Choisir un référent\");\n      break;\n      \n    case 'chooseSuppleant':\n      chooseUser('Suppleant',\"Choisir un suppléant\");\n      break;\n      \n    case 'okProducteur':\n      $('#producer').val($('#user-choose :selected').text());\n      var id = $('#user-choose :selected').val();\n      document.getElementById('producer').dataset.id=id;\n      $('#choose-user').modal('hide');\n      break;\n\n    case 'okReferent':\n      $('#referent').val($('#user-choose :selected').text());\n      var id = $('#user-choose :selected').val();\n      document.getElementById('referent').dataset.id=id;\n      $('#choose-user').modal('hide');\n      break;\n\n    case 'okSuppleant':\n      $('#replace').val($('#user-choose :selected').text());\n      var id = $('#user-choose :selected').val();\n      document.getElementById('replace').dataset.id=id;\n      $('#choose-user').modal('hide');\n      break;\n  \n    case 'save':\n      saveContrat();\n      break;\n\n    case 'doc':\n      editDoc();\n      break;\n  \n    default:\n      console.log(\"Dans contrat - doAction: \"+action);\n      break;  \n  }\n}\n\n/**\n * \n * @param {int} id    contrat à modifier, 0 si nouveau\n */\nfunction initFormContact(id)\n{\n  modal.createModal(\"id-contrat\", \"contrat-edit\", \"Gestion de contrat\",\"modal-xl\");\n  // Ajout du contenu contrat-edit-content\n  data ={\n    Action: \"Content\",\n    Content: \"ContratEdit\"\n  };\n  $.post(\"/ajax/index.php\", data, function (data) {\n    $('#contrat-edit-content').html(data);\n    document.getElementById('contractName').dataset.id = id;\n  });\n  var Btns=[{\n    Label:    \"Enregistrer\",\n    Func:     \"contrat\",\n    Action:   \"save\",\n    Glyph:    \"save\",\n    type:     \"primary\"\n  },{\n    Label:    \"Nouvelle saison\",\n    Func:     \"contrat\",\n    Action:   \"new\",\n    Glyph:    \"repeat\",\n    type:     \"primary\"\n  },{\n    Label:    \"Quitter\",\n    Func:     \"\",\n    Action:   \"\",\n    Glyph:    \"log-out\",\n    type:     \"secondary\"\n  }];\n  if( id != 0){\n    // get data\n    data={\n      Action: \"contrat\",\n      Want:   \"getInfo\",\n      Vars:   id\n    }\n    $.post(\"/ajax/index.php\", data, function (resp) {\n      console.log(resp);\n      $('#contractName').val(resp.Data[0].Name);\n      document.getElementById('contractName').dataset.id=resp.Data[0].id;\n      $('#contratType option[value=\"'+resp.Data[0].idContratType+'\"]').prop('selected', true);\n      $('#producer').val(resp.Data[0].Producteur);\n      document.getElementById('producer').dataset.id=resp.Data[0].IdProducteur;\n      $('#referent').val(resp.Data[0].Referent);\n      document.getElementById('referent').dataset.id=resp.Data[0].IdReferent;\n      $('#replace').val(resp.Data[0].Suppleant);\n      document.getElementById('replace').dataset.id=resp.Data[0].IdSupleant;\n      $('#currentSeason').val(resp.Data[0].EnCours);\n      if( resp.Data[0].Verouille == 1){\n        $('#locked').prop(\"checked\",true);\n      } else {\n        $('#locked').prop(\"checked\",false);\n      }\n      var Debut = resp.Data[0].DebutContrat;\n      var debContrat = Debut.substr(8,2)+\"/\"+Debut.substr(5,2);\n      $('#contract-start').val(debContrat);\n      var Fin = resp.Data[0].FinContrat;\n      var finContrat = Fin.substr(8,2)+\"/\"+Fin.substr(5,2);\n      $('#contract-end').val(finContrat);\n      $('#nbPeople').val(resp.Data[0].nbPermanence);\n      $('#amount').val(resp.Data[0].PrixContrat);\n    });\n  }\n  modal.addButtons(\"contrat-edit\",Btns);\n  $('#contrat-edit').modal('show');\n}\n\nfunction chooseUser(type, title)\n{\n  modal.createModal(\"contrat-edit\", \"choose-user\", title,\"modal-sm\");\n  var Btns=[{\n    Label:    \"Choisir\",\n    Func:     \"contrat\",\n    Action:   \"ok\"+type,\n    Glyph:    \"ok\",\n    type:     \"primary\"\n  },{\n    Label:    \"Quitter\",\n    Func:     \"\",\n    Action:   \"\",\n    Glyph:    \"log-out\",\n    type:     \"secondary\"\n  }];\n  modal.addButtons(\"choose-user\",Btns);\n  var sel = document.createElement('select');\n  sel.id=\"user-choose\";\n  sel.className=\"form-control\";\n  sel.style.height=\"200px\";\n  sel.style.minHeight=\"200px\";\n  sel.multiple=true;\n  var div = document.getElementById('choose-user-content');\n  div.appendChild(sel);\n  var i =0;\n  data={\n    Action:  \"contrat\",\n    Want:    \"get\"+type\n  };\n  $.post(\"/ajax/index.php\", data, function (resp) {\n    resp.forEach(function(user){\n      var option = document.createElement('option');\n      option.text = user.Raisoc;\n      option.value = user.id;\n      sel.add(option);\n\n    });\n  });\n\n  $('#choose-user').modal('show');\n}\n\nfunction saveContrat()\n{\n  var formValid = true;\n  // Valider si on a bien les infos\n  if( $('#contractName').val() == \"\"){\n    formValid = false;\n  }\n  var sPost='';\n  sPost += '{\"id\":\"'+document.getElementById(\"contractName\").dataset.id+'\",';\n  sPost += '\"Name\":\"'+document.getElementById(\"contractName\").value+'\",';\n  sPost += '\"Type\":\"'+$(\"#contratType :selected\").val()+'\",';\n  var idProducer = document.getElementById(\"producer\").dataset.id;\n  if( idProducer == '0'){\n    formValid = false;\n  }\n  sPost += '\"idProducteur\":\"'+idProducer+'\",';\n  var idReferent = document.getElementById(\"referent\").dataset.id;\n  if( idReferent == '0'){\n    formValid = false;\n  }\n  var idSuppleant = document.getElementById(\"replace\").dataset.id;\n  sPost += '\"idReferent\":\"'+idReferent+'\",';\n  sPost += '\"idSuppleant\":\"'+idSuppleant+'\",';\n  sPost += '\"curSeason\":\"'+$(\"#currentSeason\").val()+'\",';\n  if($(\"#locked\").is(\":checked\")){\n    sPost += '\"locked\":\"true\",';\n  } else {\n    sPost += '\"locked\":\"false\",';\n  }\n  sPost += '\"Start\":\"'+$(\"#contract-start\").val() +'\",';\n  sPost += '\"End\":\"'+$(\"#contract-end\").val() +'\",';\n  sPost += '\"nbPeople\":\"'+$(\"#nbPeople\").val()+'\",';\n  sPost += '\"price\":\"'+$(\"#amount\").val()+'\"}';\n  if( formValid ){\n    console.log(sPost);\n    var data={\n      Action: \"contrat\",\n      Want:   \"save\",\n      Vars:   sPost\n    }\n    $.post('/ajax/index.php',data,function(resp){\n      if(resp.Errno != 0){\n        alert(resp.ErrMsg);\n        return false;\n      }\n      $('#contrat-edit').modal('hide');\n    });\n  }\n}\n\n\nfunction editDoc()\n{\n  console.log('Dans editDoc');\n  modal.createModal(\"contrat-edit\", \"edit-doc\", \"Contrat papier\",\"modal-sm\");\n  var Btns=[{\n    Label:    \"Quitter\",\n    Func:     \"\",\n    Action:   \"\",\n    Glyph:    \"log-out\",\n    type:     \"secondary\"\n  }];\n  modal.addButtons(\"edit-doc\",Btns);\n  var p = document.createElement('p');\n  p.innerHTML=\"Document actuel: contrat.pdf<br/>Anciens contrats\";\n  document.getElementById('edit-doc-content').appendChild(p);\n  var p = document.createElement('p');\n  p.innerHTML=\"Nouveau document: \";\n  document.getElementById('edit-doc-content').appendChild(p);\n  var input = document.createElement('input');\n  input.type=\"file\";\n  input.id=\"load-doc\";\n  p.appendChild(input);\n\n  $('#edit-doc').modal('show');\n}","/**\n * \n * @param {string}   parent \n * @param {string}   id \n * @param {string}   titre \n * @param {string}   size     classe pour la taille de la boite modale <modal-xl||>\n */\nexport function createModal(parent, id, titre, size) {\n  var Div = document.createElement('div');\n  Div.className = \"modal fade\";\n  Div.id = id;\n  Div.setAttribute(\"role\", \"dialog\");\n  Div.setAttribute(\"aria-labelledby\", id);\n  Div.setAttribute(\"aria-hidden\", \"true\");\n  document.body.appendChild(Div);\n  var Div2 = document.createElement('div');\n  Div2.className = \"modal-dialog \"+size;\n  Div2.setAttribute(\"role\", \"document\");\n  Div.appendChild(Div2);\n  var Div3 = document.createElement('div');\n  Div3.className = \"modal-content\";\n  Div2.appendChild(Div3);\n  var Div4 = document.createElement('div');\n  Div4.className = \"modal-header\";\n  Div3.appendChild(Div4);\n  var Header = document.createElement('h5');\n  Header.className = \"modal-title\";\n  Header.innerText = titre;\n  Div4.appendChild(Header);\n  var Btn = document.createElement('button');\n  Btn.setAttribute(\"type\", \"button\");\n  Btn.setAttribute(\"data-dismiss\", \"modal\");\n  Btn.className = \"close\";\n  Div4.appendChild(Btn);\n  var Span = document.createElement('span');\n  Span.setAttribute(\"aria-hidden\", \"true\");\n  Span.innerText = \"x\";\n  Btn.appendChild(Span);\n  var DivContent = document.createElement('div');\n  DivContent.className = \"modal-body\";\n  DivContent.id = id + '-content';\n  Div3.appendChild(DivContent);\n  var DivFoot = document.createElement('div');\n  DivFoot.className = \"modal-footer\";\n  DivFoot.id = id + \"-footer\";\n  Div3.appendChild(DivFoot);\n\n  $('#' + id).on('show.bs.modal', function () {\n    $('#' + parent).css('opacity', 0.5);\n  });\n  $('#' + id).on('hidden.bs.modal', function () {\n    $('#' + parent).css('opacity', 1);\n    $('#' + id).remove();\n  });\n\n  // $('#'+id).modal('show');\n}\n\n/**\n * \n * @param {*} id \n * @param {*} Btns \n */\nexport function addButtons(id, Btns)\n{\n  Btns.forEach(function(Button){\n    var Btn = document.createElement('button');\n    Btn.setAttribute(\"type\", \"button\");\n    if( Button.Func.length != 0){\n      Btn.onclick = function () {\n        var call = Button.Func+\"('\"+Button.Action+\"','');\";\n        eval(call);         \n      };  \n    }\n    Btn.className = \"btn btn-\"+Button.type;\n    if( Button.Glyph == \"log-out\"){\n      Btn.setAttribute(\"data-dismiss\", \"modal\");\n    }\n    Btn.innerHTML = \"<span class='glyphicon glyphicon-\"+Button.Glyph+\"'></span> \"+Button.Label;\n    document.getElementById(id+\"-footer\").appendChild(Btn);\n  });\n}"],"sourceRoot":""}